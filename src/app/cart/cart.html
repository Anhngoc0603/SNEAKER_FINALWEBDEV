<div class="cart-overlay" 
     [class.active]="cartService.isOpen$ | async" 
     (click)="cartService.closeCart()">
</div>

<div class="cart-sidebar" [class.active]="cartService.isOpen$ | async">
  <div class="cart-header">
    <h2 class="cart-title">Shopping Cart (<span>{{ cartService.getCount() }}</span>)</h2>
    <button class="close-btn" (click)="cartService.closeCart()">×</button>
  </div>

  <div class="cart-items">
    <div class="cart-empty" *ngIf="(cartService.cartItems$ | async)?.length === 0">
      <svg class="cart-empty-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"/>
      </svg>
      <p>Your cart is empty</p>
    </div>

    <div class="cart-item" *ngFor="let item of cartService.cartItems$ | async; let i = index">
      <img [src]="item.image" [alt]="item.name" class="cart-item-image">
      <div class="cart-item-details">
        <div class="cart-item-name">{{ item.name }}</div>
        <div class="cart-item-meta">
          <span>Size: {{ item.size }}</span>
          <span>|</span>
          <span>Color: {{ getColorName(item.color) }}</span>
        </div>
        <div class="cart-item-price">{{ formatPrice(item.price) }}</div>
        <div class="quantity-controls">
          <button class="quantity-btn" (click)="cartService.updateQuantity(i, item.quantity - 1)">−</button>
          <span class="quantity-value">{{ item.quantity }}</span>
          <button class="quantity-btn" (click)="cartService.updateQuantity(i, item.quantity + 1)">+</button>
        </div>
      </div>
      <button class="remove-btn" (click)="cartService.removeFromCart(i)">
        <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
        </svg>
      </button>
    </div>
  </div>

  <div class="cart-footer" *ngIf="(cartService.cartItems$ | async)?.length! > 0">
    <div class="cart-total">
      <span class="cart-total-label">Total:</span>
      <span class="cart-total-amount">{{ formatPrice(cartService.getTotal()) }}</span>
    </div>
    <button class="checkout-btn" routerLink="/checkout" (click)="cartService.closeCart()">
      Proceed to Checkout
    </button>
  </div>
</div>